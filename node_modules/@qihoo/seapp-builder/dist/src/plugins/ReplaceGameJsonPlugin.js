"use strict";
var fs = require('fs-extra');
var relativeToCwd = require('../helper/path').relativeToCwd;
var ReplaceGameJsonPlugin = /** @class */ (function () {
    function ReplaceGameJsonPlugin(options) {
        // String
        this.name = 'ReplaceGameJsonPlugin';
    }
    ReplaceGameJsonPlugin.prototype.apply = function (compiler) {
        var that = this;
        compiler.hooks.emit.tapAsync(that.name, function (compilation, callback) {
            var content = fs.readFileSync(relativeToCwd('game.json'), 'utf-8');
            var json = JSON.parse(content);
            var orgJson = {
                'deviceOrientation': 'portrait',
                'networkTimeout': {
                    'request': 5000,
                    'connectSocket': 5000,
                    'uploadFile': 5000,
                    'downloadFile': 5000
                },
                'sdkversion': '1.0.0',
                'window': {
                    'enableLargeWindow': false,
                    'showRefreshButton': false,
                    'windowWidth': 640,
                    'windowHeight': 1136,
                    'enableResize': false,
                    'autoScale': false
                },
                'engine': 'egret'
            };
            var gameJson = JSON.stringify(Object.assign({}, orgJson, json), null, 2);
            compilation.assets['game.json'] = {
                source: function () {
                    return gameJson;
                },
                size: function () {
                    return gameJson.length;
                }
            };
            callback();
        });
    };
    return ReplaceGameJsonPlugin;
}());
module.exports = ReplaceGameJsonPlugin;
//# sourceMappingURL=ReplaceGameJsonPlugin.js.map